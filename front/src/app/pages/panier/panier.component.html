<div
    class="container bg-gradient-to-br from-[#FAF3E7] via-[#F3E5D0] to-[#E8D5C4] min-h-[calc(100vh-64px)] -mt-40 flex items-center justify-center p-6">

    <div class="max-w-4xl w-full grid grid-cols-1 gap-8 items-start">

        <div class="text-center md:text-left md:pl-8">
            <h2 class="text-3xl font-semibold text-gray-900 mb-4">Votre Panier</h2>
            <p class="text-gray-600">
                Retrouvez ici tous les produits ajoutés. Vous pouvez supprimer un produit ou vider le panier.
            </p>
        </div>

        <div class="bg-white/80 backdrop-blur-sm border border-gray-100 rounded-xl shadow-md p-8">

            <div *ngIf="produits.length > 0; else panierVide" class="space-y-6">

                <div *ngFor="let produit of produits"
                    class="flex flex-col md:flex-row justify-between items-center border-b pb-4 gap-4">
                    <img [src]="produit.image" alt="{{ produit.nom }}" class="w-24 h-24 object-cover rounded-md">

                    <div class="flex-1">
                        <p class="font-medium text-gray-800">{{ produit.nom }}</p>
                        <p class="text-gray-500 text-sm capitalize">{{ produit.categorie }}</p>
                        <p class="text-gray-700 font-semibold mt-1">{{ produit.prix }} € x {{ produit.quantite }} = {{
                            produit.prix * produit.quantite }} €</p>
                    </div>

                    <div class="flex gap-2 items-center">
                        <button (click)="decrement(produit.id)"
                            class="px-3 py-1 rounded-md border border-red-400 text-red-600 hover:bg-red-50 transition">
                            -
                        </button>
                        <button (click)="supprimer(produit.id)"
                            class="px-3 py-1 rounded-md border border-red-400 text-red-600 hover:bg-red-50 transition">
                            Supprimer
                        </button>
                    </div>
                </div>
                <div class="mt-6 p-4 bg-gray-100 rounded-lg">
                    <label class="block text-gray-700 font-medium mb-2">Code promo</label>

                    <div class="flex gap-3">
                        <input type="text" [(ngModel)]="promoCode" placeholder="Entrez votre code promo"
                            class="flex-1 px-3 py-2 border rounded-md focus:outline-none focus:ring focus:ring-pink-300">

                        <button (click)="applyPromo()"
                            class="px-4 py-2 bg-pink-600 text-white rounded-md hover:bg-pink-700 transition">
                            Appliquer
                        </button>
                    </div>

                    <p *ngIf="promoApplied" class="text-green-600 font-medium mt-2">
                        Code appliqué : {{
                        promoApplied.discountType === 'percent'
                        ? '-' + promoApplied.value + '%'
                        : '-' + promoApplied.value + '€'
                        }}
                    </p>
                </div>
                <div *ngIf="err" class="fade mb-4 p-3 rounded-md bg-red-100 text-red-700 border border-red-300">
                    {{ err}}
                </div>
                <div *ngIf="success"
                    class="fade mb-4 p-3 rounded-md bg-green-100 text-green-700 border border-green-300">
                    {{success }}
                </div>

                <div class="flex justify-between items-center pt-4 border-t mt-4">
                    <span class="font-bold text-gray-800 text-lg">Total :</span>
                    <span class="font-bold text-gray-800 text-lg">{{ totalFinal() }} €</span>

                </div>
                <div class="flex gap-4 mt-4 flex-wrap">
                    <button (click)="viderPanier()"
                        class="flex-1 py-2.5 bg-red-600 text-white rounded-md shadow hover:bg-red-700 transition">
                        Vider le panier
                    </button>
                    <button routerLink="/payment"
                        class="flex-1 py-2.5 bg-pink-600 text-white rounded-md shadow hover:bg-pink-700 transition">
                        Passer à la caisse
                    </button>
                </div>

            </div>
            <ng-template #panierVide>
                <p class="text-gray-600 text-center py-12">Votre panier est vide.</p>
                <div *ngIf="success"
                    class="fade mb-4 p-3 rounded-md bg-green-100 text-green-700 border border-green-300">
                    {{success }}
                </div>
            </ng-template>

        </div>

    </div>
</div>